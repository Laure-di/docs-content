---
meta:
    title: Automating Apple Silicon Server Creation with Terraform and Ansible
    description: Learn how to automate the creation and management of Apple Silicon servers using Terraform and Ansible. This guide provides step-by-step instructions for both tools
content:
    h1: Automating Apple Silicon Server Creation with Terraform and Ansible
    description: Learn how to automate the creation and management of Apple Silicon servers using Terraform and Ansible. This guide provides step-by-step instructions for both tools
categories:
    - apple-silicon
    - terraform
    - ansible
tags: apple-silicon terraform ansible
---

In this tutorial, weâ€™ll guide you through automating the setup and management of Apple Silicon servers using two powerful tools: [Terraform](https://www.terraform.io/) and [Ansible](https://www.ansible.com/). By leveraging these tools, you can streamline infrastructure management, reduce manual configuration, and ensure consistent environments.

<Macro id="requirements" />

- A Scaleway account logged into the [console](https://console.scaleway.com)
- [Owner](/identity-and-access-management/iam/concepts/#owner) status or [IAM permissions](/identity-and-access-management/iam/concepts/#permission) allowing you to perform actions in the intended Organization
- A valid [API key](/identity-and-access-management/iam/how-to/create-api-keys/)

## Understanding the Tools

### HashiCorp Terraform
[Terraform](https://www.terraform.io/) is an open-source Infrastructure as Code (IaC) tool that allows you to define and manage infrastructure using declarative configuration files. Terraform enables you to create reproducible and scalable environments while automating the deployment of resources.

### Ansible
[Ansible](https://www.ansible.com/) is an automation tool that simplifies configuration management, application deployment, and task automation. By using playbooks, Ansible helps automate and streamline processes, ensuring consistency and efficiency in managing complex infrastructure.

## How to create an apple-silicon server

### Using Terraform

1. Download and install [Terraform](https://developer.hashicorp.com/terraform/install)

2. Create a Directory: First, create a directory for your Terraform project. Open your terminal and run:

```shell
mkdir apple_silicon_server_terraform
cd apple_silicon_server_terraform
```

3. Create a Terraform Configuration File: Inside this directory, create a file named resources.tf:

```shell
touch resources.tf
```

4. Define the Required Providers: Open the resources.tf file and add the following configuration to define the Scaleway provider and set the required Terraform version:

```shell
terraform {
  required_providers {
    scaleway = {
      source = "scaleway/scaleway"
    }
  }
  required_version = ">=0.13"
}

```

5. Define the Apple Silicon Server: Add the following code to define your Apple Silicon server (M2-M type) in the same resources.tf file:

```terraform
#resources.tf
resource "scaleway_apple_silicon_server" "server" {
    name = "MyAwesomeServer"
    type = "M2-M"
    zone = "fr-par-1"
}
```

6. Apply the Configuration: To apply this configuration, run the following commands in your terminal:

```shell
#Initialize Terraform
terraform init
#Plan the deployment
terraform plan
#Create the server
terraform apply
```

When prompted, type yes to confirm the creation of the resources.

7. Enable Virtual Private Cloud (VPC) and Private Network: To enhance the network setup, you can update the configuration to enable VPC option and attach a private network to your Apple Silicon server. Update your resources.tf file with the following

```terraform
#resources.tf
resource "scaleway_vpc" "vpc01" {
    name = "MyAwesomeVPC"
}

resource "scaleway_vpc_private_network" "pn01" {
    name = "MyAwesomePN"
    vpc_id = scaleway_vpc.vpc01.id
}

resource "scaleway_apple_silicon_server" "server" {
    name = "MyAwesomeServer"
    type = "M2-M"
    zone = "fr-par-1"
    enable_vpc = true
    private_network {
          id = scaleway_vpc_private_network.pn01.id
    }
}
```
8. Apply the Configuration Update: Finally, run the following command to apply the changes and update the server configuration

```shell
terraform apply
```

This will apply the new settings, ensuring that the server is launched within the specified VPC and connected to the private network.

### Using Ansible

1. Install Ansible: You can install Ansible using pip, the Python package manager. Run the following command:

```shell
pip install ansible
```

2. Install Scaleway Ansible Collection: Run the following command to install the Scaleway collection for Ansible:

```shell
ansible-galaxy collection install scaleway.scaleway
```

3. Create a Directory: First, create a directory for your Ansible project. Open your terminal and run:

```shell
mkdir apple_silicon_server_ansible
cd apple_silicon_server_ansible
```

4. Create a Playbook: Create a new file named create_applesilicon_server.yml:

```shell
touch create_applesilicon_server.yml
```

5. Define the Playbook Content: Open create_applesilicon_server.yml in your text editor and add the following content:

```ansible
---
- name: Create Apple Silicon Server on Scaleway
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Create an Apple Silicon server
      scaleway.scaleway.scaleway_applesilicon_server:
        access_key: "{{ scw_access_key }}"
        secret_key: "{{ scw_secret_key }}"
        state: present
        type_: "M2-M"  # Replace with your desired server type
        name: "my-applesilicon-server"  # Optional: specify a name for your server
        zone: "fr-par-1"  # Optional: specify the zone if needed
        project_id: "your_project_id"  # Optional: specify the project ID
      register: applesilicon_server

    - name: Output server information
      debug:
        var: applesilicon_server
```

6. Ensure to replace your_project_id with your actual project ID if applicable.

7. Replace Placeholders: Ensure to replace your_project_id with your actual project ID if applicable.

```shell
ansible-playbook create_applesilicon_server.yml -e "scw_access_key=YOUR_ACCESS_KEY scw_secret_key=YOUR_SECRET_KEY"
```
Replace YOUR_ACCESS_KEY and YOUR_SECRET_KEY with your actual Scaleway credentials.

8. Check the Output: The playbook will output the details of the created server, including its ID, IP address, status, and other relevant information.

## How to read server info

### Using Terraform

To read server information after creation, you can use the terraform output command, assuming you have defined output variables in your resources.tf. For example:

```terraform
#resources.tf
output "server_ip" {
  value = scaleway_apple_silicon_server.server.ip
}
```

After applying the configuration, run:

```shell
terraform output server_ip
```

### Using Ansible

